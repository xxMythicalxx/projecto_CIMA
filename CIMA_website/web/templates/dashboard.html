<!DOCTYPE html>
<html>
	<head>
        <meta charset="UTF-8"/>
		<title>Admin-Mode</title>
        <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css"/>
    <script> var a = localStorage.getItem('isDarkMode'); var back = ''; var text = ''; if(a=='true'){window.back = "#2d2d2d";window.text = "#ffffff"; }else{window.back = "#fff"; window.text = "#545454";}</script>
		<script >
            const logout = () => {  
				Swal.fire({
                    title: 'Cerrar Sesion',
                    text: "¿Está Seguro De Querer Cerrar La Sesión?",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Si',
                    toast: true,
                    background: back,
                    color: text,
                    cancelButtonText: 'Cancelar',
                    }).then((result) => {
                    if (result.isConfirmed) {
                        window.location.href = "/logout";
                    }
                    })
            }
        </script>
        <script>
        let count = 3599;
        const timer = setInterval(function() {
        //console.log(count);
        count--;
        if (count === 0) {
            clearInterval(timer);
            Swal.fire({
                title: 'Sesion Caducada',
                'icon':'error',
                toast: true,
                background: back,
                color: text,
                }).then((result) => {
                if (result.isConfirmed) {
                window.location.href = "/";
            }
            })
        }
        }, 1000);
        </script>       
</head>
<body>
  {% load static %}
	<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <div  class="vh-100 d-flex justify-content-center ">
	<div class="container-fluid" id="backgroundall">		
		<nav class="navbar " id="navbarcenter">
            <div class="container-fluid" >
				<button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="offcanvas offcanvas-start" tabindex="-1" id="offcanvasNavbar">
					<div class="navbar-nav" align="center" >
                        <div class="offcanvas-header text-center">
                          <img src="{% static 'img/insignia_CIMA3.png' %}" alt="Imagen de ejemplo" style="width: 150px; height: 150px; border-radius: 50%; object-fit: cover;display: block;margin-left: auto;margin-right: auto;" >
                            <button type="button" class="btn-close position-fixed" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                          </div>
						            <a class="btn btn-outline-secondary active nav-link text-center" href="/adminn">Dashboard</a>
                        {% for g in grup %}
                        {% for perm in g.permissions %}
                        {% if perm.codename == 'view_categoria' %}
						            <a class="btn btn-outline-secondary nav-link text-center" href="/ShowGestionC">Gestionar Categoria</a>
                        {% endif %}
                        {% if perm.codename == 'view_alumno' %}
                        <a class="btn btn-outline-secondary nav-link text-center" href="/ShowGestionA">Gestionar Alumnos</a>
                        {% endif %}
                        {% if perm.codename == 'view_proveedor' %}
						            <a class="btn btn-outline-secondary nav-link text-center" href="/ShowGestionProveedor">Gestionar Proveedores</a>
                        {% endif %}
                        {% if "view_producto" in perm.codename  %}
                        <a class="btn btn-outline-secondary nav-link text-center product-link" href="/ShowGestionP">Gestionar Productos</a>
                        {% endif %}
                        {% if perm.codename == 'view_movimiento' %}
                        <a class="btn btn-outline-secondary nav-link text-center" href="/ShowGestionS">Gestionar Stock</a>
                        {% endif %}
                        {% if perm.codename == 'view_historial_acciones' %}
                        <a class="btn btn-outline-secondary nav-link text-center" href="/ShowHis">Ver Historial de acciones</a>
                        {% endif %}
                        {% endfor %}
                        {% endfor %}
						            <a class="btn btn-outline-danger nav-link text-center" onClick="logout()">Cerrar Sesión</a>
                        <a class="nav-link" style="margin: 0 auto;float: none;" ><div class="form-check form-switch" style="margin: 0 auto;float: none;">
                            <input
                            class="form-check-input p-2"
                            type="checkbox"
                            role="switch"
                            id="2"
                            onclick="myFunction()"
                            />
                        </div></a>
								
					      </div>
                    <div class="" style="height: 100%;" >
                    <h5 id="TheEmail" class="position-absolute bottom-0 start-50 translate-middle-x">{{correo}}</h5>
                    <button id="showEmail2" style="display: none; border: none; outline: 0;" type="button" onClick="ChangeShowEmail()" class="btn btn-lg btn-outline-secondary position-absolute bottom-0 end-0">
                        <i class="bi bi-eye-slash"></i>
                    </button>
                    <button id="showEmail" style="display: block; border: none; outline: 0;" type="button" onClick="ChangeShowEmail()" class="btn btn-lg btn-outline-secondary position-absolute bottom-0 end-0">
                        <i class="bi bi-eye"></i>
                    </button>
                    </div>
				    </div>
                <h1 class="d-flex justify-content-end align-items-center" style="margin: 0 auto;float: none;">Dashboard</h1>
            </div>
		</nav>
		<div class="d-flex justify-content-end align-items-center text-center">
			<div class="container-fluid">
                <div class="row content">    
                    <div class="col-sm-12">
                      <div class="well">
                      </div>
                      <div class="row">
                        <div class="col-sm-12">
                          <div class="well">
                          <h2>Bienvenido Usuario</h2>
                          <h4>{{request.user.email}}</h4> 
                          </div>
                        <!-- </div>
                        <div class="col-sm-3">
                          <div class="well">
                            <h4>Productos Totales</h4>
                            <p>100 Million</p> 
                          </div>
                        </div>
                        <div class="col-sm-3">
                          <div class="well">
                            <h4>Pedidos Totales</h4>
                            <p>10 Million</p> 
                          </div>
                        </div>
                        <div class="col-sm-3">
                          <div class="well">
                            <h4>Proveedores Totales</h4>
                            <p>1 Million%</p> 
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-sm-4">
                          <div class="well">
                          </div> -->
                        </div>
                      </div>
                    </div>
                  </div>
            </div>       
        </div>  
	</div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function() {
          // Variable para controlar si el enlace "Gestionar Productos" ya ha sido mostrado
          let productLinkDisplayed = false;
  
          // Seleccionar todos los enlaces "Gestionar Productos"
          const productLinks = document.querySelectorAll('.product-link');

          console.log(productLinks)
          productLinks.forEach(link => {
              // Si ya se ha mostrado, ocultamos este enlace
              if (productLinkDisplayed) {
                  link.style.display = 'none';
              } else {
                  // Marcamos que el enlace ha sido mostrado
                  productLinkDisplayed = true;
              }
          });
      });
  </script>	

<script>
    var a = document.getElementById("showEmail");
    var b = document.getElementById("showEmail2");
    var e = document.getElementById("TheEmail");
    var t = localStorage.getItem('ShowEmail');
    // console.log(t)
        if (t==="true"){
            e.innerHTML = '{{correo}}';
            a.style.display = "block";
            b.style.display = "none";
            //console.log('b')
        }
        if(t==="false"){
            e.innerHTML = '***';
            a.style.display = "none";
            b.style.display = "block";
        }
        //console.log("c")
    </script>

<script>
    function ChangeShowEmail() {
        var element = document.body;
        var a = document.getElementById("showEmail");
        var b = document.getElementById("showEmail2");
        var e = document.getElementById("TheEmail");
        console.log(a)
        if (a.style.display == "block"){
            localStorage.setItem('ShowEmail', false);
            e.innerHTML = '***';
            a.style.display = "none";
            b.style.display = "block";
        }
        else{
            localStorage.setItem('ShowEmail', true);
            e.innerHTML = '{{correo}}';
            a.style.display = "block";
            b.style.display = "none";
        }
    }
</script>

<script>
    $(document).ready(function(){
      $("#myInput").on("keyup", function() {
        var value = $(this).val().toLowerCase();
        $("#myTable tr").filter(function() {
          $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
        });
      });
    });
</script>

<script>
    function test() {
    Swal.fire({
    position: 'top',
    icon: 'success',
    title: 'test',
    showConfirmButton: false,
    timer: 1500
})}</script>
<script>
    var element = document.body;
    var a = localStorage.getItem('isDarkMode');
    var back = '';
    var text = '';
    if(a=='true'){window.back = "#2d2d2d";window.text = "#ffffff"; }else{window.back = "#fff"; window.text = "#545454";}  
    //console.log(a)
        if (a==="true"){
            element.dataset.bsTheme = "dark"
            document.getElementById("2").checked = true;
            document.getElementById("offcanvasNavbar").style.backgroundColor= '#791500';
            document.getElementById("offcanvasNavbar").style.color= '#FFFFFF';
            document.getElementById("backgroundall").style.backgroundColor= '#404040';
            document.getElementById("backgroundall").style.color= '#FFFFFF';
            document.getElementById("navbarcenter").style.backgroundColor= '#791500';
            document.getElementById("navbarcenter").style.color= '#FFFFFF';
            // document.getElementById('head_table').setAttribute("class", "table-light");
            // document.getElementById('head_table2').setAttribute("class", "table-light");
            //console.log('b')
        }
        if(a==="false"){
            element.dataset.bsTheme = "light";
            document.getElementById("offcanvasNavbar").style.backgroundColor = '#c19284';
            document.getElementById("offcanvasNavbar").style.color= '#000000';
            document.getElementById("backgroundall").style.backgroundColor = '#c19284';
            document.getElementById("backgroundall").style.color= '#000000';
            document.getElementById("navbarcenter").style.backgroundColor = '#8a8a8a';
            document.getElementById("navbarcenter").style.color= '#000000';
            // document.getElementById('head_table').setAttribute("class", "table-dark");
            // document.getElementById('head_table2').setAttribute("class", "table-dark");
        }
        //console.log("c")
    </script>
<script>
    function myFunction() {
        var element = document.body;
        var darkcheck = document.getElementById("2");
        //console.log(darkcheck)
        if (darkcheck.checked){
            element.dataset.bsTheme = "dark"
            localStorage.setItem('isDarkMode', true);
            document.getElementById("offcanvasNavbar").style.backgroundColor= '#791500';
            document.getElementById("offcanvasNavbar").style.color= '#FFFFFF';
            document.getElementById("backgroundall").style.backgroundColor= '#404040';
            document.getElementById("backgroundall").style.color= '#FFFFFF';
            document.getElementById("navbarcenter").style.backgroundColor= '#791500';
            document.getElementById("navbarcenter").style.color= '#FFFFFF';
            // document.getElementById('head_table').setAttribute("class", "table-light");
            // document.getElementById('head_table2').setAttribute("class", "table-light");
            back = "#2d2d2d"; text = "#ffffff";
        }
        else{
            element.dataset.bsTheme = "light"
            localStorage.setItem('isDarkMode', false);
            document.getElementById("offcanvasNavbar").style.backgroundColor = '#c19284';
            document.getElementById("offcanvasNavbar").style.color= '#000000';
            document.getElementById("backgroundall").style.backgroundColor = '#c19284';
            document.getElementById("backgroundall").style.color= '#000000';
            document.getElementById("navbarcenter").style.backgroundColor = '#8a8a8a';
            document.getElementById("navbarcenter").style.color= '#000000';
            // document.getElementById('head_table').setAttribute("class", "table-dark");
            // document.getElementById('head_table2').setAttribute("class", "table-dark");
            back = "#fff"; text = "#545454";
        }
    }
    </script>

    {% if r2 %}
    <script>
        Swal.fire({
        'title':'Error',
        'text':"{{r2}}",
        toast: true,
        background: back,
        color: text,
        'icon':'error'
    })</script>
    {% endif %}



    {% if r %}
    <script>
        Swal.fire({
        position: 'top',
        icon: 'success',
        title: '{{r}}',
        toast: true,
        background: back,
        color: text,
        showConfirmButton: false,
        timer: 3000,
        timerProgressBar: true,
    })</script>
    {% endif %}
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
	
</body>
</html>